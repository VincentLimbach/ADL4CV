import torch
#torch.Size([128, 64, 32])
#torch.Size([76, 32])
#torch.Size([128, 64])
#torch.Size([128, 1, 64])
#torch.Size([76, 32])
#torch.Size([128, 1])
w_1 = torch.ones(128, 64, 32)
x = torch.ones(76, 32)
b_1 = torch.ones(128, 64)
c = w_1 @ x.T + b_1.unsqueeze(2)
w_2 = torch.ones(128, 1, 64)
b_2 = torch.ones(128, 1)
c_3 = torch.bmm(c.transpose(1,2), w_2.transpose(1,2))+b_2.unsqueeze(1)
print(w_2.shape)
print(b_2.shape)
print(c_3.shape)
#print(c_3)